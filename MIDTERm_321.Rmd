---
title: "Midterm_321"
author: "Richard Coyle"
date: "2025-10-17"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
```



```{r}
red <- read_delim("/Users/jamescoyle/Desktop/ISTA 321 MIDTERM/winequality-red.csv", delim = ";", show_col_types = FALSE) %>%
  mutate(type = "red")
white <- read_delim("/Users/jamescoyle/Desktop/ISTA 321 MIDTERM/winequality-white.csv", delim = ";", show_col_types = FALSE) %>%
  mutate(type = "white") 

wine <- bind_rows(red, white) %>%
  relocate(type) %>%
  mutate(type = factor(type))

glimpse(wine)
summary(wine$quality)
view(wine)
```


```{r pressure, echo=FALSE}
num_vars <- wine %>% select(where(is.numeric))
cor_mat <- cor(num_vars, use = "pairwise.complete.obs")
round(sort(cor_mat[, "quality"], decreasing = TRUE), 3)
```

```{r}
full_formula <- quality ~ `fixed acidity` + `volatile acidity` + `citric acid` +
  `residual sugar` + chlorides + `free sulfur dioxide` + `total sulfur dioxide` +
  density + pH + sulphates + alcohol + type

lm_full <- lm(full_formula, data = wine)
summary(lm_full)
```

```{r}
feat <- c("alcohol", "volatile acidity", "density", "sulphates", "chlorides", "fixed acidity")

plot_df <- wine %>%
  select(quality, all_of(feat)) %>%
  pivot_longer(-quality, names_to = "feature", values_to = "value")

ggplot(plot_df, aes(value, quality)) +
  geom_point(alpha = 0.15, size = 1) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ feature, scales = "free_x", ncol = 3) +
  labs(title = "How chemistry relates to wine quality",
       x = "Feature value", y = "Quality (0â€“10)") +
  theme_minimal(base_size = 13)
```

